# 04 부자연스러움을 해결하는 도메인 서비스 



## 4.1 서비스란?

서비스는 클라이언트를 위해 무언가를 해주는 객체

* 도메인을 위한 서비스 (이 장에서의 서비스)
* 애플레케이션을 위한 서비스



## 4.2 도메인 서비스란?

값 객체나, 엔티티로 구현하기 어색한 행동을 해결해주는 객체



### 4.2.1 값 객체나 엔티티에 정의하기 어색한 행동

* 예제프로젝트: Ex04_01



### 4.2.2 부자연스러움을 해결해주는 객체 - 도메인 서비스

* 도메인 서비스는 `자신의 행동을 바꿀 수 있는 인스턴스만의 값을 갖지 않는 다는 점`에서 값 객체나 엔티티와 다름.



## 4.3 도메인 서비스를 남용한 결과

* ✨ 엔티티나 값 객체에 정의하기 부자연스러운 처리에 한정해서만 도메인 서비스에 정의한다.
* 모든 처리 코드를 도메인 서비스로 옮기면 도메인 객체는 그저 데이터를 저장할 뿐, 별다른 정보를 제공할 수 없는 객체가 되어버린다. 
  * 필드와 Getter, Setter 밖에 없는...
  * 다른 개발 참여자들이 코드를 보고 도메인 규칙을 발견하기 어려운 상태가됨



### 4.3.1 도메인 서비스는 가능한 한 피할 것

* ✨어떤 행위를 엔티티에 구현할지? 도메인 서비스에 구현할지 해깔리면, 우선 엔티티나, 값 객체에 먼저 정의해볼것!





## 4.4 엔티티/값 객체와 함께 유스케이스 수립하기



### 4.4.1 사용자 엔티티 확인



### 4.4.2 사용자 생성 처리 구현

데이터스토어를 다루는 토드들이 나열되는데, 이부분은 다음장 `5장. 데이터와 관계된 처리를 분리하자 - 리포지토리`에서 다루겠다..



### 저자님 의견 : 도메인 서비스의 기준

* 어떤 처리를 도메인 서비스로 만들어야할지를 판단할 때, 그 처리가 도메인에 기초한 것인지를 중요하게 봄.

* `사용자명 중복`이라는 개념이 도메인에 기초한 것이라면 이를 구현하는 서비스도 도메인 서비스여야함.

* 애플리케이션을 만들어 필요가게 된 것이라면 그런 처리는 애플리케이션 서비스로 정의해야함.

  



## 4.5 물류 시스템의 도메인 서비스 예

* 예제 프로젝트: Ex04_03

### 4.5.1 거점의 행동으로 정의하기

### 4.5.2 운송 도메인 서비스 정의하기

어떤 처리를 객체 안에 정의했을 때, 잘 들어맞지 않는 느낌이 든다면 이 처리를 도메인 서비스에 옮기면 자연스럽게 나타낼 수 있음.

```csharp
var 운송서비스 = new TransportService();
var 지점a = new PhysicalDistributionBase();
var 지점b = new PhysicalDistributionBase();

var 화물a = new Baggage(new BaggageId("화물a"));

운송서비스.Transport(지점a, 지점b, 화물a);
```





## 정리

* 도메인 객체에 구현하기 자연스럽지못한 행위가 있음.
  * 도메인 객체를 가로질로 이뤄지는 처리가 대부분.
  * 이 행위들을 도메인 서비스에 정의해여 자연스럽게 만들 수 있음.

* 빈혈도메인 (DTO 같은 도메인...)이 생기지 않도록 행위를 어따 구현할지 신경쓸 것.



## 챕터 진행

> 코드와 같이하면 좋긴한데.. C# 환경을 잘 몰라서 복잡해지면 실제 실행하기가 힘든 것 같다. 😥
>
> ✨ 외부 시스템에 의존하거나 복잡한 코드 실행은 우선 건너뛰는 것이 좋을 것 같다. 



## 기타

* 유스케이스란?

  * https://www.ksga.org/sgstandard/framework/01/03/01.do

    ```
    유스케이스란 일반적으로 “시스템의 하나 이상의 액터 또는 이해관계자에게 
    관측 가능한 결과를 산출하는 시스템에 의해 수행되는 일련의 활동의 명세”1)로 정의할 수 있다.
    조금 더 쉽게 표현하자면 어떤 행위와 관련된 액터 간에 수행되는 활동을 기술한 것이라고 이해할 수 있다.
    ```
  
  * p71쪽의 Program 클래스에서 User엔티티 User서비스들을 사용해 사용자를 생성 처리 방법을 코드로 나타낸 것이 유스케이스나 마찬가지 같다.





## 정오표

* 없음
